---
title: 语句与表达式
description: 语句与表达式
---

Rust 中的语法可以分成两大类：语句 (Statement) 和表达式 (Expression)。语句是指要执行的一些操作和产生副作用的表达式，表达式主要用于计算求值。

语句又分为两种：声明语句 ( Declaration statement) 和表达式语句 ( Expression statement)。

- 声明语句，用于声明各种语言项 (Item), 包括声明变量、静态变量、常量、结构体、函数等，以及通过 `extern` 和 `use` 关键字引入包和模块等。
- 表达式语句，特指以分号结尾的表达式。此类表达式求值结果将会被舍弃，并总是返回单元类型 `()`。

``` rust
// extern crate std;
// use std::prelude::v1::*;
fn main() {
    pub fn answer() -> () {
        let a = 40;
        let b = 2;
        assert_eq!(sum(a, b), 42);
    }

    pub fn sum(a:  i32, b:  i32) -> i32 {
        a + b
    }

    answer();
}
```

第 1 行和第 2 行代码是声明语句，它们并不需要求值，只是用来引入标准库包以及 `prelude` 模块的。这里之所以将它们注释掉，是因为 Rust 会为每个 `crate` 都会自动引入标准库模块，除非使用 `#[no_std]` 属性明确指定了不需要标准库。然后使用关键字 `fn` 定义了两个函数 `answer` 和 `sum`。关键字 `fn` 是 `function` 的缩写。

函数 `answer` 没有输入参数，并且返回值为单元类型 `()`。单元类型拥有唯一的值，就是它本身，为了描述方便，将该值称为单元值。单元类型的概念来自 OCmal，它表示"没有什么特殊的价值"。所以，这里将单元类型作为函数返回值，就表示该函数无返回值。当然，通常无返回值的函数默认不需要在函数签名中指定返回类型。

在函数 `answer` 中，使用 `let` 声明了两个变量 a 和 b，其后必须加分号。`assert_eq!` 则是宏语句，它是 Rust 提供的断言，允许判断给定的两个表达式求值结果是否相同。像这种名字以叹号结尾，并且可以像函数一样被调用的语句，在 Rust 中叫作宏。

函数 `sum` 的两个输入参数和返回值均指定为 `i32` 类型。其函数体只包含了一个表达式，用于计算 a 与 b 的值，并返回。

Rust 编译器在解析代码的时候，如果碰到分号，就会继续往后面执行；如果碰到语句，则执行语句；如果碰到表达式，则会对表达式求值，如果分号后面什么都没有，就会补上单元值 `()`。

当 Rust 编译器遇到函数的时候，会将函数体的花括号识别为块表达式 (Block Expression)。块表达式是由一对花括号和一系列表达式组成的，它总是返回块中最后一个表达式的值。因此，对于 `answer` 函数来说，它也是一个块表达式，块中的最后一个表达式是宏语句，所以返回单元值 `()`。对于 `sum` 函数来说，其最后一行是一个表达式，因为没有分号，所以直接返回其求值结果。

从这个角度来看，可以将 Rust 看作一切皆表达式。由于当分号后面什么都没有时自动补单元值 `()` 的特点，我们可以将 Rust 中的语句看作计算结果均为 `()` 的特殊表达式。而对于普通的表达式来说，则会得到正常的求值结果。
